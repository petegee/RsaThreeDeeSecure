using System;
using System.Collections.Generic;
using System.Security.Cryptography.X509Certificates;
using FluentAssertions;
using RsaThreeDeeSecure.Jwe;
using UnitTests.TestData;
using Xunit;

namespace UnitTests
{
    public class JwsHeaderTests
    {
        private JweMessage.JwsHeader ClassUnderTest { get; set; }
        private readonly DateTimeOffset _now = DateTimeOffset.Now;

        protected JwsHeaderTests()
        {
            SystemTime.Set(() => _now);
        }

        public class CreateJwsHeaderForNewMessage : JwsHeaderTests
        {
            private const string CardInfoEncryptedMessage =
                "eyJhbGciOiJSUzI1NiIsImNyaXQiOlsiZXhwIl0sImV4cCI6MTU1OTE5MzcxNywieDVjIjpbIk1JSUpPekNDQ0NPZ0F3SUJBZ0lDRUNJd0RRWUpLb1pJaHZjTkFRRUxCUUF3WGpFTE1Ba0dBMVVFQmhNQ1NVd3hDekFKQmdOVkJBZ01BazVCTVF3d0NnWURWUVFLREFOU1UwRXhGVEFUQmdOVkJBc01ERE5FVTJWamRYSmxJREl1TURFZE1Cc0dBMVVFQXd3VWNuTmhMbWx1ZEdWeWJXbGthV0YwWlM1amIyMHdIaGNOTVRrd016TXhNRGN4TnpJMldoY05Namt3TXpJNE1EY3hOekkyV2pCdk1Rc3dDUVlEVlFRR0V3SkpUREVRTUE0R0ExVUVDQk1IVlc1cmJtOTNiakVTTUJBR0ExVUVCeE1KU0dWeWVtbHNhWGxoTVF3d0NnWURWUVFLRXdOU1UwRXhFVEFQQmdOVkJBc1RDRE5FVTJWamRYSmxNUmt3RndZRFZRUUREQkJqYkdsbGJuUmZjMmxuYm1GMGRYSmxNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXFsNys4KytOaERLMGNxVnZWeUU1d1FhWDZrR0RzTE1ONnZ3NVNJR3RxRmZpUnpNVittdndmL3NRbEJIcktmZ2VYNDNOYXVZcVlaMmpJakV0SzhpeGY0SjV0S1JqWFYrRTNjY0tYMDN6K0NWNXRnUDNUQ3VPdXZDRS8xeXg4blRlWFFudWFXRVJNN0R0RisvbFp6bG9XUnZXcTdrdjQ5V3VRaHJ2TUlNcy9ldDhaUjUvYmNkUHBad3JwLzZueE5Eb29ockc2NU1Hd045bWduTkFLd2xxcHhyUnNSQy9jWkFiR0pYM0l1aFFyN0lmL0NUSktQM1FucGU0dHBJcVY2QVNnSVN0SEJodzBQLzZsdENEVkRnRytFOXgyR0RIR1d5cURrQ2d5NjVpSGZpQmpndnRud2RPaUt1dnpwWmltbnlGODdsL2MwL1g3L3piUHNIMW1XM3ViUUlEQVFBQm80SUY4RENDQmV3d2dnVWlCZ05WSFJFRWdnVVpNSUlGRllJZ2QzZDNMbXhwYm5WNGNtUTBNREF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDSEd4cGJuVjRjbVEwTURBdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0NteHBiblY0Y21RME1EQ0NJSGQzZHk1c2FXNTFlSEprTXpBd0xtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdoeHNhVzUxZUhKa016QXdMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRnZ3BzYVc1MWVISmtNekF3Z2lCM2QzY3ViR2x1ZFhod2N6UXlNQzVvZW14aFlpNXNZV0l1WlcxakxtTnZiWUljYkdsdWRYaHdjelF5TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJS2JHbHVkWGh3Y3pReU1JSWdkM2QzTG14cGJuVjRjSE0wTVRBdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0hHeHBiblY0Y0hNME1UQXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNDbXhwYm5WNGNITTBNVENDSUhkM2R5NXNhVzUxZUhGaE1UUXdMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRnaHhzYVc1MWVIRmhNVFF3TG1oNmJHRmlMbXhoWWk1bGJXTXVZMjl0Z2dwc2FXNTFlSEZoTVRRd2dpQjNkM2N1YkdsdWRYaHhZVEV6TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJY2JHbHVkWGh4WVRFek1DNW9lbXhoWWk1c1lXSXVaVzFqTG1OdmJZSUtiR2x1ZFhoeFlURXpNSUlnZDNkM0xteHBiblY0Y1dFeE1qQXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNIR3hwYm5WNGNXRXhNakF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDQ214cGJuVjRjV0V4TWpDQ0lIZDNkeTVzYVc1MWVIRmhNVEV3TG1oNmJHRmlMbXhoWWk1bGJXTXVZMjl0Z2h4c2FXNTFlSEZoTVRFd0xtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdncHNhVzUxZUhGaE1URXdnaVpoYm1Gc2VYUnBZM011YkdsdWRYaHdjelF4TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJbVlXNWhiSGwwYVdOekxteHBiblY0Y0hNME1qQXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNKbUZ1WVd4NWRHbGpjeTVzYVc1MWVIRmhNVEV3TG1oNmJHRmlMbXhoWWk1bGJXTXVZMjl0Z2laaGJtRnNlWFJwWTNNdWJHbHVkWGh4WVRFeU1DNW9lbXhoWWk1c1lXSXVaVzFqTG1OdmJZSW1ZVzVoYkhsMGFXTnpMbXhwYm5WNGNXRXhNekF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDSm1GdVlXeDVkR2xqY3k1c2FXNTFlSEZoTVRRd0xtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdndHNhVzUxZUhCemNqSXhNSUlkYkdsdWRYaHdjM0l5TVRBdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0lYZDNkeTVzYVc1MWVIQnpjakl4TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJSmJIaGlZVzFpWVRBeWdodHNlR0poYldKaE1ESXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNIM2QzZHk1c2VHSmhiV0poTURJdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0hIZDNkeTVzYm5GaE1URXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNCbXh1Y1dFeE1ZSVliRzV4WVRFeExtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdoeDNkM2N1Ykc1eFlUSXlMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRnZ1pzYm5GaE1qS0NHR3h1Y1dFeU1pNW9lbXhoWWk1c1lXSXVaVzFqTG1OdmJZSUtiR2x1ZFhoeFlUSXpNSUljYkdsdWRYaHhZVEl6TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJZ2QzZDNMbXhwYm5WNGNXRXlNekF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDQ214cGJuVjRjV0V4TVRLQ0hHeHBiblY0Y1dFeE1USXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNJSGQzZHk1c2FXNTFlSEZoTVRFeUxtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdoTXFMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRNQjBHQTFVZERnUVdCQlI0TUVGRWJNMG8zMXdWTjQwaXdPRC9tOVFwaWpDQmxnWURWUjBqQklHT01JR0xnQlQ1NlJiTmRrczNKbUptdG5zcC9lQUV3bjZEbWFGdnBHMHdhekVMTUFrR0ExVUVCaE1DU1V3eEN6QUpCZ05WQkFnTUFrNUJNUkV3RHdZRFZRUUhEQWhJWlhKNlpXeHBZVEVYTUJVR0ExVUVDZ3dPVWxOQklFTnZjbkFzSUVsdVl5NHhEREFLQmdOVkJBc01Bek5FVXpFVk1CTUdBMVVFQXd3TU0wUlRJRkp2YjNRZ1NGTk5nZ0lTVFRBTUJnTlZIUk1FQlRBREFRSC9NQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFYRTY0dGlGTkpGZDlCUVZIMngrUHFNOWwyb1g4MzVQVms4ZTk4dGpwbW9QcGMrdDg5RWkwdVNGcklITzBnbUkvV1gzYVBQZFVzdXNkbjZLVWxnOXg2SUQvM0VWQjhta3JQOFNoRkhNWGFtRFhMcmZMa1YvUjIzRHdCSktOa3NrbTNjNlluRFJBTm1vOHV3V3luajY2dEZCUG8zaW5TSmFQUWEyN1pBUEJVK3ZoRjdZbEdqUTNaU0RpMkZvQXlFeVVlelRoQkYwK0c5T3B1MEYyVVJxSFZCcWNnUHR6T0M5V0ZxQUdsSTBnN3NwcjZYRXZublFSNWNOK3JEYWRYSXFzOWczMGJGOE5vTWU2cWFaTncxVngxU1VnNCtZRW03a25UZjMzQUNIU0kyWjlGNEQrODdNR3ZLaUZxZVVnckRqUk1IWVFKT3IxU0xzTy9CbDU0YnQ4ZCIsIk1JSUV3RENDQXFpZ0F3SUJBZ0lDRWswd0RRWUpLb1pJaHZjTkFRRUxCUUF3YXpFTE1Ba0dBMVVFQmhNQ1NVd3hDekFKQmdOVkJBZ01BazVCTVJFd0R3WURWUVFIREFoSVpYSjZaV3hwWVRFWE1CVUdBMVVFQ2d3T1VsTkJJRU52Y25Bc0lFbHVZeTR4RERBS0JnTlZCQXNNQXpORVV6RVZNQk1HQTFVRUF3d01NMFJUSUZKdmIzUWdTRk5OTUI0WERURTVNREl5T0RFeE5UZ3pPRm9YRFRJeE1ESXlOekV4TlRnek9Gb3dYakVMTUFrR0ExVUVCaE1DU1V3eEN6QUpCZ05WQkFnTUFrNUJNUXd3Q2dZRFZRUUtEQU5TVTBFeEZUQVRCZ05WQkFzTURETkVVMlZqZFhKbElESXVNREVkTUJzR0ExVUVBd3dVY25OaExtbHVkR1Z5Yldsa2FXRjBaUzVqYjIwd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURkNk9WQU1tKzZZYWl0b0xWeXQweXhOaWhtOXVWczBFRmpSc3dIOW9GdWpWaGUycTRiOUdzWGNLQ0lXWE1LK3N6MjNpWVZWVWNkUm5DNnNNNm8wdTNsblN2TlJRL3Y2azRINkxIaVBMU0NNMlg2WEh1ZSt2Vm16U1JuOXlUaGczVWZrTDJiaHltNU1qOE1CaGo3bERJVnRLcTFhbmp3bCtxMU4zcXVsdzRMWXdraml1TjNCekhmam5UVzh2aGNlZTM2aE9vcmZFTWExSUtXcWdaL3hlUDFjenMxd09aaUttSmpzWVNHc1BtQzE0UjhZbzhCMCsySlF6RUtWbytlVmxvS1BGZ2pIQmxWZDZWRDU3Qjlkc0tIUDVFSXRQaGJsUVJmQ0FMcWlJVm5rSUJaR2hkWHloeVN3bFJSeWc4R3g0YWFFVnBKeVdqTlNFUWtxT3dTTGxIVEFnTUJBQUdqZXpCNU1Ba0dBMVVkRXdRQ01BQXdMQVlKWUlaSUFZYjRRZ0VOQkI4V0hVOXdaVzVUVTB3Z1IyVnVaWEpoZEdWa0lFTmxjblJwWm1sallYUmxNQjBHQTFVZERnUVdCQlQ1NlJiTmRrczNKbUptdG5zcC9lQUV3bjZEbVRBZkJnTlZIU01FR0RBV2dCU21RYVZRZWtONEN6Ylg4ZVVGMkpseUo1dzdhakFOQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBSVVTazkrRTR1bG83ajBIVDhaMWoxSUVkRWFsOEMwc3cvN1VUNkZPaFNxcDk2a1V3ZWEzTTBHcWFZeWhVUXB0enM4Rnh0Z05rVnFXZG8rTkh1V05TRHJjWi9kM2kyVGYwMkJKR2JqcFpsTjRqVGJOSXMvYXBIUU9yRElhcVB0dkFjOUdsZVFqbERSRVd4Z3N1b0E2SXUrSEV2S2thY2lsdzNZZW0rdGt3ZEV3aUp0WHBiQk42c0VnV2J1UW8vZTZqMFR2YnpzcUpDNGMxeUNZaUI4Sk9OODFLZTlXQXZiWWxnMHZBTmF6SzltQURPZzlvc3huNXVCTkh4ekx6bENSQUovQ1dpSkhaUStxenZYWkI5end5NTJrWHNXQ2lMZ2pPUzU3d21QK1FKYXRMSzZRdmQ0WDI2YkFtdjlsTEpIM05jUDJXa0MvR1U3eTFLM1lHSTBRU1dPTmVxWm1seEMvbUZ4RWpzSlR5L0JVUHNsNkZvVkxTdHI1a2J5WFRnWEFOODlSR213MnpQQWJVRU16WFY3SlFGUjJNa1VjTTF4aThsVmRXOXJlc2lBTi9SeCtvcDlzYUdkOHpLbHJnUzNxakpKWDc5cVhBNm05YURwbFJWZWN0a2M3ZnZuaEhyYmRYN3dmekxhbE40SFgydVRxcUltaDJCSElwelkvZzhvbTVHbDZZdlJiT3RyUkFad1JDTVBSdkptM05VOE5TKzVQNmhjZXB5ZktMZ3JLMW5lS3FpRmVIS291aXJLeEkxdm03dURXZFFTQlpMY2txNitqZkpXejhvY0VDMkp4VlNOVGxhdjB0R0U3eGhINFltWGJ0ZGJ4bnFaNlJPOUFsWmxFSXYzTGJMTHlsT21XcTA5MWlvSDJQdnA4VTl4SndJc2FkS2JCUHR1YmtrNWM9IiwiTUlJRnFUQ0NBNUdnQXdJQkFnSUpBTTdmOGlZQjhZTCtNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1Hc3hDekFKQmdOVkJBWVRBa2xNTVFzd0NRWURWUVFJREFKT1FURVJNQThHQTFVRUJ3d0lTR1Z5ZW1Wc2FXRXhGekFWQmdOVkJBb01EbEpUUVNCRGIzSndMQ0JKYm1NdU1Rd3dDZ1lEVlFRTERBTXpSRk14RlRBVEJnTlZCQU1NRERORVV5QlNiMjkwSUVoVFRUQWVGdzB4T0RBek1UVXhNelExTWpKYUZ3MHlPREF6TVRJeE16UTFNakphTUdzeEN6QUpCZ05WQkFZVEFrbE1NUXN3Q1FZRFZRUUlEQUpPUVRFUk1BOEdBMVVFQnd3SVNHVnllbVZzYVdFeEZ6QVZCZ05WQkFvTURsSlRRU0JEYjNKd0xDQkpibU11TVF3d0NnWURWUVFMREFNelJGTXhGVEFUQmdOVkJBTU1ERE5FVXlCU2IyOTBJRWhUVFRDQ0FpSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnSVBBRENDQWdvQ2dnSUJBUEYyeElERXVJc2VJMHJReDRvNlRJRmhqNlRSVTJYTnhlMnI1KzViU2kxZTBqOTVPRDlTemE0aTJHZnFJL2dUdGovSFBiUUUwUGpyWklUVlJSdjNZd09DYk0wUjBqUGFXeHFvNXZBTzVObzJzSHZJcFkxQ3lIckhPNU9zcDQ1N1FzcWI1YnRPMm41bE1iTGh1RWEwYS9najdHYTN0VCswTHk1QzFjeGVyOXI2cXFRVHVscWx1aHNSTFBLN2JPeHZsN0NUMnpjSlZZMDlOZENka3dNQnQ5ak84eE5kVjhhVVBLL3dNRUJrOFFCMTY2Tm50dXlMNVFQQUVZL0EvakZsOUdQUnhVUjRqRWNxbmEvSVNrbUc1UHB4RVAzbFlrS1pBY3h1MVBDd2VmTlhnNXdnZDhuQ1BOc1dKL0FrTGZnbUVmV3ZFZnlRUlBNWXhzdmJ3VlZHc2NQRytzVXphU1kzcit3blVnVTJodmNMaHdqRVk1VCtielNZSGo2am04OG85Q2R5NDNsckE3UW5hVEkxWkt2OVZJcmxLMzZnRkJIQ0hDdlROSyt4RDVUcGhpV1lFckhjMk8zY0tjL1FCN0xzeWZqVGdjM3hZcExwWC9oZkxRbzNtMjVPdDJNK29uRWxkWDE4V2Rib0I4VmtHckdZZkkvZWwxVVFhbUQ5RUY0N0FQZDlqMVE4eW5ZaGQzckZuWnUxMExvOXdLajV1YTZBMVBCdUgyNzFsYS9sZUhJZDVMTGUrbUg5REZJdFNDUWw1Vytzbk00d2FXSnhFclNoR2RpNmVXMHRLd0l0aTZ5TThNQVRUOXlLcGRnekNVdnBMSDZidyt3ZWlRbFh1bERBbVZnam52U0dSbVVxOXlGNThwbURZMzgwVEthaktBQ3VneXNSalVYT2V0STFBZ01CQUFHalVEQk9NQXdHQTFVZEV3UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZLWkJwVkI2UTNnTE50Zng1UVhZbVhJbm5EdHFNQjhHQTFVZEl3UVlNQmFBRktaQnBWQjZRM2dMTnRmeDVRWFltWElubkR0cU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQzVtczBYM2k5dFB6YUZtZjl0eERsOE40YnpNUjRYNXdjTjlySzdiSXU1R0xtWlZycHlJdnF2YVV3NFZFazM5TnRleU1ybzVsRERjMW03QXZuVzRYQnBPeStBQTd3TEFXcWU1a0xOdnpobzN2YmRNMXQ3ZTJXRnhYZFZ5T1VGazdIU2l0ZUNWWVk0S1JGczFpQnlMeC8rSnpZSnd4RElWRG5WSXQ5NHYvajNLaDQvYVZRbnBaY1prdGlIUnNHdFRndTE1ejExc01QNy9Zc0NtSHNtc1FwdWN4QWsralNHNW1PQ2crSDdHRUNEWmlDN1RZNU9CaFU2SDkzNE9PN0NLVERycTl0b0ZuVkptZ01Pd2xmS2NkZ0pWbENmUUhYaUYrWUtqazhwaHRLN3V3Ri9wRVpXdzhMRGVLZGZLRGJrWmI4Y0tBY0lnVFdhdU9lN2xlZmFRNHVTYWVjNUVIL3NRd3B3Z216a09FOEpmZzEySEo4bnRKSjF0d005RzNFcnRmSTFvRDFtWkdpbmVseG1rdXV2bzEyTEp3L2VxZlNET3FYZW1RYzVmTi8rWWgxNnM0UUNMaVdndkFmeTMrMzMxUWp3cC82SFdjZVdHODUvQnd5cmdtNHpsSThiM0xMRmdYYnU5aEFyLzM5NlhTTzMzWGl4N1gxV1lQZ0JUNHUrZlhYNnJ6WElLYzY0Z3J2QWY4MG9rdHRUZUJ6VXpYeWNrRXRkOXdnTmVpUmpJMXlrRnU4NEtaN1JkVDJiVjdZZXRXWCt2UTV1ZjhObXlFNFhCa2RldWdRSSt6amt0b2d6dW41V2dFb3cvcGJ4NFo2bXJSWE9YVEx3aXY0SnhPYTNUZ0pkNk84WVlad1ZzbVVDUXdlTE5rUjcxdHNqM3FzRGJBcmJncXFtQVdPa3ZnPT0iXX0.ZXlKaGJHY2lPaUpTVTBFdFQwRkZVQ0lzSW1WdVl5STZJa0V4TWpoRFFrTXRTRk15TlRZaUxDSjROV01pT2xzaVRVbEpTbEJFUTBORFExTm5RWGRKUWtGblNVTkZRMFYzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkWWFrVk1UVUZyUjBFeFZVVkNhRTFEVTFWM2VFTjZRVXBDWjA1V1FrRm5UVUZyTlVKTlVYZDNRMmRaUkZaUlVVdEVRVTVUVlRCRmVFWlVRVlJDWjA1V1FrRnpUVVJFVGtWVk1sWnFaRmhLYkVsRVNYVk5SRVZrVFVKelIwRXhWVVZCZDNkVlkyNU9hRXh0YkhWa1IxWjVZbGRzYTJGWFJqQmFVelZxWWpJd2QwaG9ZMDVOVkd0M1RYcE5lRTFFWTNoT2VrVXdWMmhqVGsxcWEzZE5la2swVFVSamVFNTZSVEJYYWtKM1RWRnpkME5SV1VSV1VWRkhSWGRLU2xSRVJWRk5RVFJIUVRGVlJVTkNUVWhXVnpWeVltMDVNMkpxUlZOTlFrRkhRVEZWUlVKNFRVcFRSMVo1Wlcxc2MyRlliR2hOVVhkM1EyZFpSRlpSVVV0RmQwNVRWVEJGZUVWVVFWQkNaMDVXUWtGelZFTkVUa1ZWTWxacVpGaEtiRTFTYjNkSFFWbEVWbEZSUkVSQ1JucGFXRW95V2xoS1pscFhOV3BqYm14M1pFZHNkbUpxUTBOQlUwbDNSRkZaU2t0dldrbG9kbU5PUVZGRlFrSlJRVVJuWjBWUVFVUkRRMEZSYjBOblowVkNRVXRRWW5aNlRYRm1OR3BITVRGbFdHMXdaVkI1V1hFNWNsaEdNU3RRWWxaeFZWUjVORE5RVUhJd2IzVjBNemxYV1cxdlFUQXJjV3BUVG5oaFRWWndPRWtyWVdONGVqUk9WeTlNTUVKMk5VVlJXbG92WmprNE9UWlJNMGt6VjBOcE1HaDJjR05GYjB0YVUzUkNTVTh5UTFaV2JHbFVVbmRpYUd4M1ZWZEJaV2RQY25GMFNubE1RMDlUVGk5cFZuUkdNamtyTUVRd01ra3hlWEJCVVd0dGRGbGhSekJUWVdKSGREaHZibTVpWVVZeVkxRlBNbTltVDFZelJXVmpZV1l5TVdsbFZrd3dVVTV4ZUcxRFIzZERLekUyUXpaS05FYzBRWFYzUm5ocmNsTnNPVEJOUzFSeVdEUTRVRmw0WjJkSE9XSXljMWhLVFUxdFNVeE1Sa3hpUjFvcmQyRXhVMmhXY1VWdk16Rm1iblJGY25odlFWcFVlV2RNTlhBNFkxaElhRU4zVGt4WlFrTjBLMHhRWTB4NWFqRjZiRWhtVmpaMGJWTlBXR05aVVZBMGFIbHFla1p6WldGSVYwOHJhRmxyUkRSamJYcFBZME5CZDBWQlFXRlBRMEptUVhkbloxaHpUVWxKUmtsbldVUldVakJTUWtsSlJrZFVRME5DVWxkRFNVaGtNMlI1TlhOaFZ6VXhaVWhLYTA1RVFYZE1iV2cyWWtkR2FVeHRlR2haYVRWc1lsZE5kVmt5T1hSbmFIaHpZVmMxTVdWSVNtdE9SRUYzVEcxb05tSkhSbWxNYlhob1dXazFiR0pYVFhWWk1qbDBaMmR3YzJGWE5URmxTRXByVGtSQmQyZHBRak5rTTJOMVlrZHNkV1JZYUhsYVJFMTNUVU0xYjJWdGVHaFphVFZ6V1ZkSmRWcFhNV3BNYlU1MllsbEpZMkpIYkhWa1dHaDVXa1JOZDAxRE5XOWxiWGhvV1drMWMxbFhTWFZhVnpGcVRHMU9kbUpaU1V0aVIyeDFaRmhvZVZwRVRYZE5TVWxuWkROa00weHRlSEJpYmxZMFkwaE5NRTFxUVhWaFNIQnpXVmRKZFdKSFJtbE1iVlowV1hrMWFtSXlNa05JUjNod1ltNVdOR05JVFRCTmFrRjFZVWh3YzFsWFNYVmlSMFpwVEcxV2RGbDVOV3BpTWpKRFEyMTRjR0p1VmpSalNFMHdUV3BEUTBsSVpETmtlVFZ6WVZjMU1XVklRbnBPUkVWM1RHMW9ObUpIUm1sTWJYaG9XV2sxYkdKWFRYVlpNamwwWjJoNGMyRlhOVEZsU0VKNlRrUkZkMHh0YURaaVIwWnBURzE0YUZscE5XeGlWMDExV1RJNWRHZG5jSE5oVnpVeFpVaENlazVFUlhkbmFVSXpaRE5qZFdKSGJIVmtXR2g0V1ZSRk1FMUROVzlsYlhob1dXazFjMWxYU1hWYVZ6RnFURzFPZG1KWlNXTmlSMngxWkZob2VGbFVSVEJOUXpWdlpXMTRhRmxwTlhOWlYwbDFXbGN4YWt4dFRuWmlXVWxMWWtkc2RXUllhSGhaVkVVd1RVbEpaMlF6WkROTWJYaHdZbTVXTkdOWFJYaE5la0YxWVVod2MxbFhTWFZpUjBacFRHMVdkRmw1TldwaU1qSkRTRWQ0Y0dKdVZqUmpWMFY0VFhwQmRXRkljSE5aVjBsMVlrZEdhVXh0Vm5SWmVUVnFZakl5UTBOdGVIQmlibFkwWTFkRmVFMTZRME5KU0dRelpIazFjMkZYTlRGbFNFWm9UVlJKZDB4dGFEWmlSMFpwVEcxNGFGbHBOV3hpVjAxMVdUSTVkR2RvZUhOaFZ6VXhaVWhHYUUxVVNYZE1iV2cyWWtkR2FVeHRlR2haYVRWc1lsZE5kVmt5T1hSblozQnpZVmMxTVdWSVJtaE5WRWwzWjJsQ00yUXpZM1ZpUjJ4MVpGaG9lRmxVUlhoTlF6VnZaVzE0YUZscE5YTlpWMGwxV2xjeGFreHRUblppV1VsallrZHNkV1JZYUhoWlZFVjRUVU0xYjJWdGVHaFphVFZ6V1ZkSmRWcFhNV3BNYlU1MllsbEpTMkpIYkhWa1dHaDRXVlJGZUUxSlNXMVpWelZvWWtoc01HRlhUbnBNYlhod1ltNVdOR05JVFRCTlZFRjFZVWh3YzFsWFNYVmlSMFpwVEcxV2RGbDVOV3BpTWpKRFNtMUdkVmxYZURWa1IyeHFZM2sxYzJGWE5URmxTRUo2VGtSSmQweHRhRFppUjBacFRHMTRhRmxwTld4aVYwMTFXVEk1ZEdkcFdtaGliVVp6WlZoU2NGa3pUWFZpUjJ4MVpGaG9lRmxVUlhoTlF6VnZaVzE0YUZscE5YTlpWMGwxV2xjeGFreHRUblppV1VsdFdWYzFhR0pJYkRCaFYwNTZURzE0Y0dKdVZqUmpWMFY0VFdwQmRXRkljSE5aVjBsMVlrZEdhVXh0Vm5SWmVUVnFZakl5UTBwdFJuVlpWM2cxWkVkc2FtTjVOWE5oVnpVeFpVaEdhRTFVVFhkTWJXZzJZa2RHYVV4dGVHaFphVFZzWWxkTmRWa3lPWFJuYVZwb1ltMUdjMlZZVW5CWk0wMTFZa2RzZFdSWWFIaFpWRVV3VFVNMWIyVnRlR2haYVRWeldWZEpkVnBYTVdwTWJVNTJZbGxKVEdKSGJIVmtXR2gzWXpOSmVVMVVRME5JVjNod1ltNVdOR05JVG5sTmFrVjNURzFvTm1KSFJtbE1iWGhvV1drMWJHSlhUWFZaTWpsMFoybEdNMlF6WTNWaVIyeDFaRmhvZDJNelNYbE5WRUYxWVVod2MxbFhTWFZpUjBacFRHMVdkRmw1TldwaU1qSkRRMWQ0TkZsdFJuUlpiVVYzVFc5SlltSklhR2xaVnpGcFdWUkJlVXh0YURaaVIwWnBURzE0YUZscE5XeGlWMDExV1RJNWRHZG9PVE5rTTJOMVlraG9hVmxYTVdsWlZFRjVURzFvTm1KSFJtbE1iWGhvV1drMWJHSlhUWFZaTWpsMFoyaDRNMlF6WTNWaVJ6VjRXVlJGZUV4dGFEWmlSMFpwVEcxNGFGbHBOV3hpVjAxMVdUSTVkR2RuV25OaWJrWm9UVlJIUTBkSGVIVmpWMFY0VFZNMWIyVnRlR2haYVRWeldWZEpkVnBYTVdwTWJVNTJZbGxKWTJRelpETk1iWGgxWTFkRmVVMXBOVzlsYlhob1dXazFjMWxYU1hWYVZ6RnFURzFPZG1KWlNVZGlSelY0V1ZSSmVXZG9hSE5pYmtab1RXcEpkV0ZJY0hOWlYwbDFZa2RHYVV4dFZuUlplVFZxWWpJeVEwTnRlSEJpYmxZMFkxZEZlVTE2UTBOSVIzaHdZbTVXTkdOWFJYbE5la0YxWVVod2MxbFhTWFZpUjBacFRHMVdkRmw1TldwaU1qSkRTVWhrTTJSNU5YTmhWelV4WlVoR2FFMXFUWGRNYldnMllrZEdhVXh0ZUdoWmFUVnNZbGROZFZreU9YUm5aM0J6WVZjMU1XVklSbWhOVkVWNVoyaDRjMkZYTlRGbFNFWm9UVlJGZVV4dGFEWmlSMFpwVEcxNGFGbHBOV3hpVjAxMVdUSTVkR2RwUWpOa00yTjFZa2RzZFdSWWFIaFpWRVY0VFdrMWIyVnRlR2haYVRWeldWZEpkVnBYTVdwTWJVNTJZbGxKVkV0cE5XOWxiWGhvV1drMWMxbFhTWFZhVnpGcVRHMU9kbUpVUVdSQ1owNVdTRkUwUlVablVWVXdPRzlWYUZsRk9HdFFhMjVHVDJ0cWJWcDJVRGxPTjFNMVFUaDNaMXBaUjBFeFZXUkpkMU5DYW1wRFFtazBRVlVyWld0WGVsaGFURTU1V21sYWNsbzNTMll6WjBKTlNpdG5OVzFvWWpaU2RFMUhjM2hEZWtGS1FtZE9Wa0pCV1ZSQmEyeE5UVkZ6ZDBOUldVUldVVkZKUkVGS1QxRlVSVkpOUVRoSFFURlZSVUozZDBsVFIxWjVaVzFXYzJGWFJYaEdla0ZXUW1kT1ZrSkJiMDFFYkVwVVVWTkNSR0l6U25kTVEwSktZbTFOZFUxUmQzZERaMWxFVmxGUlRFUkJUWHBTUmsxNFJsUkJWRUpuVGxaQ1FVMU5SRVJPUlZWNVFsTmlNamt3U1VWb1ZGUlpTVU5GYXpCM1JFRlpSRlpTTUZSQ1FWVjNRWGRGUWk5NlFVNUNaMnR4YUd0cFJ6bDNNRUpCVVhOR1FVRlBRMEZSUlVGa1MzWnBLMFZPTkZsNGIzbENkRnB5UjNWRmVrOHlhRm95V2paT0wzbE1hMnRSTUVFclVsbExTSHBNUW0xTmFIaFFjRGRZTmxaMFptOHJiRFozWkVkcVNWZG1XVmxoYW1OWlpYSkJRblJDSzNwaFRHbEtiR1JhT0hwRU9FMUVjMHQyY25OQlpYcDRaeXRFV21SM2FVdExaRTkwZVRoU2RYTnlNV3hQY1dJelNtZEpUSEYxYlVZcmVDOTZkVnBvZDFreU9WYzBWakpqUlhSVUx6Tm5SR3N5YVdOSE1YWkVVeTg1ZW1WVU1qQjNkR28wYUdvd2VFTnlUVE4xTjNOamFXWnpkMk53ZDI1V1JXcE9jbWdyTTNBeVNHUlRjUzluY0hRcmVtTnRWMjVWUTFOTk56aElNRXRuYW1Rd1RHNVdUVTE2TVM5bmMzZEJWa2RTWTJwcFNtNUZZelZUVlZkeFlsa3dWbm80UTNCdU16ZHJhblYwTVdjMGIzWkhWVXBKZDBWc1VVNXhUVFZMYm5kblNtMHdUM2R6TWpGa1owTk9hMWhOWlRFMWNERnBRblZwTlVFMUwzWjRkbWszU0hGa1pXVkhaMlJPYTBFOVBTSmRmUS5iblFtc3JBd0I0Yy1ueG1VUkxvWHJubUtVNm9QaVFrSkJ5dGtiUTFHWjVpNFB5bDBvcEVtcE0xRUZsY1VZVG56eGNDdWdrRjFoSWJCQmIyc0lVYWl1QkVaM28tNkFNVzFJNlRka1NwVGsxeGlCMWU0ek9oSkxUaVdTY2xCSFBYTlpZNDJlcUZ1SEFBTm9NUHRiOEpRbVd5RExkYmM1VTZRSTNIcFhiOE5ZUzlYXy1CVVQ0LWF4dlliV1huRkthTnlORkdFM1J4bGRCb3hGWEU2cXRNVXdYN25YVFR6alQzLXFtTGFFTzBfbWlzUldRbm02NElXdG9NWkhPNUxmQmUxLXJMQmlyT0N6VzU4VEpuX3BNTU5nM0Nla3J4cXZrRkUyNGo5TW5zZ1lpcHNnVjFneERfS09HNzZBWUVjaFV1U0g5anZzcWNlOUFROWFBOXdKelNrYWcuQUc2Y3FEVWg1RWh5WTh5VFRWQ05aQS5pS0pSNkVmbHNnNWkyT0EtZHJHMlJwTUtTd1RkZlIzaXREMUM3bVBiOTJXX1pKX2tEM2xZU1g0Rk9sMWNzQ1BndTV0SG44WFplalRqMm9VNC1rOGJTTkN4bkMySEktNEdWazhoNDdiWGVLMGw5NHFDV21aX3VLT0ZTcDRoRU93cVhjMGY4aVZQNHRRTmY0MUFOY0FRcWtIUVFIeklsVDJLTzFGQ3N5dzVVcTdYUjEtMXV2WUh5MWkwUVJFX3I5bzV0bUU5VGpaMDJBODVnSW53b2ZiSWdBWnBZcndfc3RGN1FCM2dEUHNCSDZHQnpTXzNfZW50MzV6NDJVQk9MMUNOOGFwNnRiaHYwN1dpUlAxdzEtakZrR2tudER1d2NnM1Q0T3V1dFl3X3d2WE1QOFlHNGF0dTNKM0w3RzVWYXVMRWJLT05hNUI3NWNfY0VXWFloaERHUGpLdkY5MDNxenZtcmhUMy1JVTFVeHZmU2VnMVRxQlNLNlBqdVlkN1Iyb3lUVGZKaFRrQVhTeGxlRjQ4NVNrZDBDVGRqMHAyOVEyQmpFQUR6S3FlSkg5SWdBM25qQ2FyOUREX1ZNY2FrVHZNTW1wOEwzN3VlTHFVMk8xSFFqY1djQ2wtWDlWcVI2ZW04dkJyVlhta0sxNHVydHhDR3hyTWNGY3RSMEI3cFhMd054eV9senVzM3JUQ3RhMWYydU4yRC1URDZYZ1FGXzlmcVE2ekVqbHdxOFUuY1V6RFBmT3lVUDZ5T3dwejhONXpzQQ.Mw5cirD9IF0I_O878R7zzDNeaQmiPqoYco5nojaP-DxYWt7JkfNPa8SUmYuP1wyDwCEQhTli-DxywUxTLV0VtzXSEW8NMQk9iqwrRYDW5neAjRN5LDy7X-4pqZo--kQNw91GuAahhCEtkK_wcG7jrEafgrwLc6MmxHidmHDIo7l_JC4YzRSJ6ikKLGAmblXFIAqquyxCHfsIAr55K8_mOx-Q2KLAo73y2SEh_n3vRZU5XEWXcPOpDo2gYPyct2UAb005GB9D5qzNlFDgKelW8WrVHqY1IlWVzwUgLGytfP-Sdwvc67m6_RqUqIqj_z2gx7noENx7iTbrGLmLJ8ZDlw";

            private readonly string _jweHeaderAsB64 = CardInfoEncryptedMessage.Split(".")[0];

            [Fact]
            public void ShouldCreateTheHeaderWithoutError()
            {
                ClassUnderTest = JweMessage.JwsHeader.CreateJweHeaderFromEncryptedHeader(_jweHeaderAsB64);
                
                ClassUnderTest.Should().NotBeNull();
            }
            
            [Fact]
            public void ShouldCreateTheHeaderWithCorrectStaticData()
            {
                ClassUnderTest = JweMessage.JwsHeader.CreateJweHeaderFromEncryptedHeader(_jweHeaderAsB64);

                ClassUnderTest.Alg.Should().Be("RS256");
                ClassUnderTest.Crit.Should().Contain("exp");
            }
            
            [Fact]
            public void ShouldCreateTheHeaderWithSixtySecondExpiryDate()
            {
                ClassUnderTest = JweMessage.JwsHeader.CreateJweHeaderFromEncryptedHeader(_jweHeaderAsB64);

                ClassUnderTest.Expiry.Should().Be(1559193717);
            }
            
            [Fact]
            public void ShouldCreateTheHeaderWithSigningCertsInOrder()
            {
                ClassUnderTest = JweMessage.JwsHeader.CreateJweHeaderFromEncryptedHeader(_jweHeaderAsB64);

                ClassUnderTest.Certificates
                    .Should()
                    .ContainInOrder(
                        new List<X509Certificate2>
                        {
                            RsaSigningCert.GetX509Certificate2(),
                            RsaIntermediateCert.GetX509Certificate2(),
                            RsaRootCert.GetX509Certificate2()
                        });
            }
            
            [Fact]
            public void ShouldSetTheCorrectSigningPublicCert()
            {
                ClassUnderTest = JweMessage.JwsHeader.CreateJweHeaderFromEncryptedHeader(_jweHeaderAsB64);

                ClassUnderTest.SigningPublicCert
                    .Should()
                    .Be(RsaSigningCert.GetX509Certificate2());
            }
        }

        public class HasExpired : JwsHeaderTests
        {        
            public HasExpired()
            {
                ClassUnderTest = new JweMessage.JwsHeader();
            }

            [Fact]
            public void NotExpiredWhenExpiryIsSixtySecondsInTheFuture()
            {
                MessageExpiresInSecondsFromNow(60);
                    
                ClassUnderTest.HasExpired().Should().BeFalse();
            }
                
            [Fact]
            public void NotExpiredWhenExpiryOneSecondInTheFuture()
            {
                MessageExpiresInSecondsFromNow(1);
                    
                ClassUnderTest.HasExpired().Should().BeFalse();
            }
                
            [Fact]
            public void ExpiredWhenExpiryZeroSecondsInTheFuture()
            {
                MessageExpiresInSecondsFromNow(0);
                    
                ClassUnderTest.HasExpired().Should().BeTrue();
            }
                
            [Fact]
            public void ExpiredWhenExpiryIsInThePast()
            {
                MessageExpiresInSecondsFromNow(-1);
                    
                ClassUnderTest.HasExpired().Should().BeTrue();
            }
            
            private long MessageExpiresInSecondsFromNow(long seconds)
            {
                return ClassUnderTest.Expiry = _now.AddSeconds(seconds).ToUnixTimeSeconds();
            }
        }

        public class VerifyCertChain : JwsHeaderTests
        {
            private const string CardInfoEncryptedMessage =
                "eyJhbGciOiJSUzI1NiIsImNyaXQiOlsiZXhwIl0sImV4cCI6MTU1OTE5MzcxNywieDVjIjpbIk1JSUpPekNDQ0NPZ0F3SUJBZ0lDRUNJd0RRWUpLb1pJaHZjTkFRRUxCUUF3WGpFTE1Ba0dBMVVFQmhNQ1NVd3hDekFKQmdOVkJBZ01BazVCTVF3d0NnWURWUVFLREFOU1UwRXhGVEFUQmdOVkJBc01ERE5FVTJWamRYSmxJREl1TURFZE1Cc0dBMVVFQXd3VWNuTmhMbWx1ZEdWeWJXbGthV0YwWlM1amIyMHdIaGNOTVRrd016TXhNRGN4TnpJMldoY05Namt3TXpJNE1EY3hOekkyV2pCdk1Rc3dDUVlEVlFRR0V3SkpUREVRTUE0R0ExVUVDQk1IVlc1cmJtOTNiakVTTUJBR0ExVUVCeE1KU0dWeWVtbHNhWGxoTVF3d0NnWURWUVFLRXdOU1UwRXhFVEFQQmdOVkJBc1RDRE5FVTJWamRYSmxNUmt3RndZRFZRUUREQkJqYkdsbGJuUmZjMmxuYm1GMGRYSmxNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXFsNys4KytOaERLMGNxVnZWeUU1d1FhWDZrR0RzTE1ONnZ3NVNJR3RxRmZpUnpNVittdndmL3NRbEJIcktmZ2VYNDNOYXVZcVlaMmpJakV0SzhpeGY0SjV0S1JqWFYrRTNjY0tYMDN6K0NWNXRnUDNUQ3VPdXZDRS8xeXg4blRlWFFudWFXRVJNN0R0RisvbFp6bG9XUnZXcTdrdjQ5V3VRaHJ2TUlNcy9ldDhaUjUvYmNkUHBad3JwLzZueE5Eb29ockc2NU1Hd045bWduTkFLd2xxcHhyUnNSQy9jWkFiR0pYM0l1aFFyN0lmL0NUSktQM1FucGU0dHBJcVY2QVNnSVN0SEJodzBQLzZsdENEVkRnRytFOXgyR0RIR1d5cURrQ2d5NjVpSGZpQmpndnRud2RPaUt1dnpwWmltbnlGODdsL2MwL1g3L3piUHNIMW1XM3ViUUlEQVFBQm80SUY4RENDQmV3d2dnVWlCZ05WSFJFRWdnVVpNSUlGRllJZ2QzZDNMbXhwYm5WNGNtUTBNREF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDSEd4cGJuVjRjbVEwTURBdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0NteHBiblY0Y21RME1EQ0NJSGQzZHk1c2FXNTFlSEprTXpBd0xtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdoeHNhVzUxZUhKa016QXdMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRnZ3BzYVc1MWVISmtNekF3Z2lCM2QzY3ViR2x1ZFhod2N6UXlNQzVvZW14aFlpNXNZV0l1WlcxakxtTnZiWUljYkdsdWRYaHdjelF5TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJS2JHbHVkWGh3Y3pReU1JSWdkM2QzTG14cGJuVjRjSE0wTVRBdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0hHeHBiblY0Y0hNME1UQXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNDbXhwYm5WNGNITTBNVENDSUhkM2R5NXNhVzUxZUhGaE1UUXdMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRnaHhzYVc1MWVIRmhNVFF3TG1oNmJHRmlMbXhoWWk1bGJXTXVZMjl0Z2dwc2FXNTFlSEZoTVRRd2dpQjNkM2N1YkdsdWRYaHhZVEV6TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJY2JHbHVkWGh4WVRFek1DNW9lbXhoWWk1c1lXSXVaVzFqTG1OdmJZSUtiR2x1ZFhoeFlURXpNSUlnZDNkM0xteHBiblY0Y1dFeE1qQXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNIR3hwYm5WNGNXRXhNakF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDQ214cGJuVjRjV0V4TWpDQ0lIZDNkeTVzYVc1MWVIRmhNVEV3TG1oNmJHRmlMbXhoWWk1bGJXTXVZMjl0Z2h4c2FXNTFlSEZoTVRFd0xtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdncHNhVzUxZUhGaE1URXdnaVpoYm1Gc2VYUnBZM011YkdsdWRYaHdjelF4TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJbVlXNWhiSGwwYVdOekxteHBiblY0Y0hNME1qQXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNKbUZ1WVd4NWRHbGpjeTVzYVc1MWVIRmhNVEV3TG1oNmJHRmlMbXhoWWk1bGJXTXVZMjl0Z2laaGJtRnNlWFJwWTNNdWJHbHVkWGh4WVRFeU1DNW9lbXhoWWk1c1lXSXVaVzFqTG1OdmJZSW1ZVzVoYkhsMGFXTnpMbXhwYm5WNGNXRXhNekF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDSm1GdVlXeDVkR2xqY3k1c2FXNTFlSEZoTVRRd0xtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdndHNhVzUxZUhCemNqSXhNSUlkYkdsdWRYaHdjM0l5TVRBdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0lYZDNkeTVzYVc1MWVIQnpjakl4TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJSmJIaGlZVzFpWVRBeWdodHNlR0poYldKaE1ESXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNIM2QzZHk1c2VHSmhiV0poTURJdWFIcHNZV0l1YkdGaUxtVnRZeTVqYjIyQ0hIZDNkeTVzYm5GaE1URXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNCbXh1Y1dFeE1ZSVliRzV4WVRFeExtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdoeDNkM2N1Ykc1eFlUSXlMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRnZ1pzYm5GaE1qS0NHR3h1Y1dFeU1pNW9lbXhoWWk1c1lXSXVaVzFqTG1OdmJZSUtiR2x1ZFhoeFlUSXpNSUljYkdsdWRYaHhZVEl6TUM1b2VteGhZaTVzWVdJdVpXMWpMbU52YllJZ2QzZDNMbXhwYm5WNGNXRXlNekF1YUhwc1lXSXViR0ZpTG1WdFl5NWpiMjJDQ214cGJuVjRjV0V4TVRLQ0hHeHBiblY0Y1dFeE1USXVhSHBzWVdJdWJHRmlMbVZ0WXk1amIyMkNJSGQzZHk1c2FXNTFlSEZoTVRFeUxtaDZiR0ZpTG14aFlpNWxiV011WTI5dGdoTXFMbWg2YkdGaUxteGhZaTVsYldNdVkyOXRNQjBHQTFVZERnUVdCQlI0TUVGRWJNMG8zMXdWTjQwaXdPRC9tOVFwaWpDQmxnWURWUjBqQklHT01JR0xnQlQ1NlJiTmRrczNKbUptdG5zcC9lQUV3bjZEbWFGdnBHMHdhekVMTUFrR0ExVUVCaE1DU1V3eEN6QUpCZ05WQkFnTUFrNUJNUkV3RHdZRFZRUUhEQWhJWlhKNlpXeHBZVEVYTUJVR0ExVUVDZ3dPVWxOQklFTnZjbkFzSUVsdVl5NHhEREFLQmdOVkJBc01Bek5FVXpFVk1CTUdBMVVFQXd3TU0wUlRJRkp2YjNRZ1NGTk5nZ0lTVFRBTUJnTlZIUk1FQlRBREFRSC9NQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFYRTY0dGlGTkpGZDlCUVZIMngrUHFNOWwyb1g4MzVQVms4ZTk4dGpwbW9QcGMrdDg5RWkwdVNGcklITzBnbUkvV1gzYVBQZFVzdXNkbjZLVWxnOXg2SUQvM0VWQjhta3JQOFNoRkhNWGFtRFhMcmZMa1YvUjIzRHdCSktOa3NrbTNjNlluRFJBTm1vOHV3V3luajY2dEZCUG8zaW5TSmFQUWEyN1pBUEJVK3ZoRjdZbEdqUTNaU0RpMkZvQXlFeVVlelRoQkYwK0c5T3B1MEYyVVJxSFZCcWNnUHR6T0M5V0ZxQUdsSTBnN3NwcjZYRXZublFSNWNOK3JEYWRYSXFzOWczMGJGOE5vTWU2cWFaTncxVngxU1VnNCtZRW03a25UZjMzQUNIU0kyWjlGNEQrODdNR3ZLaUZxZVVnckRqUk1IWVFKT3IxU0xzTy9CbDU0YnQ4ZCIsIk1JSUV3RENDQXFpZ0F3SUJBZ0lDRWswd0RRWUpLb1pJaHZjTkFRRUxCUUF3YXpFTE1Ba0dBMVVFQmhNQ1NVd3hDekFKQmdOVkJBZ01BazVCTVJFd0R3WURWUVFIREFoSVpYSjZaV3hwWVRFWE1CVUdBMVVFQ2d3T1VsTkJJRU52Y25Bc0lFbHVZeTR4RERBS0JnTlZCQXNNQXpORVV6RVZNQk1HQTFVRUF3d01NMFJUSUZKdmIzUWdTRk5OTUI0WERURTVNREl5T0RFeE5UZ3pPRm9YRFRJeE1ESXlOekV4TlRnek9Gb3dYakVMTUFrR0ExVUVCaE1DU1V3eEN6QUpCZ05WQkFnTUFrNUJNUXd3Q2dZRFZRUUtEQU5TVTBFeEZUQVRCZ05WQkFzTURETkVVMlZqZFhKbElESXVNREVkTUJzR0ExVUVBd3dVY25OaExtbHVkR1Z5Yldsa2FXRjBaUzVqYjIwd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURkNk9WQU1tKzZZYWl0b0xWeXQweXhOaWhtOXVWczBFRmpSc3dIOW9GdWpWaGUycTRiOUdzWGNLQ0lXWE1LK3N6MjNpWVZWVWNkUm5DNnNNNm8wdTNsblN2TlJRL3Y2azRINkxIaVBMU0NNMlg2WEh1ZSt2Vm16U1JuOXlUaGczVWZrTDJiaHltNU1qOE1CaGo3bERJVnRLcTFhbmp3bCtxMU4zcXVsdzRMWXdraml1TjNCekhmam5UVzh2aGNlZTM2aE9vcmZFTWExSUtXcWdaL3hlUDFjenMxd09aaUttSmpzWVNHc1BtQzE0UjhZbzhCMCsySlF6RUtWbytlVmxvS1BGZ2pIQmxWZDZWRDU3Qjlkc0tIUDVFSXRQaGJsUVJmQ0FMcWlJVm5rSUJaR2hkWHloeVN3bFJSeWc4R3g0YWFFVnBKeVdqTlNFUWtxT3dTTGxIVEFnTUJBQUdqZXpCNU1Ba0dBMVVkRXdRQ01BQXdMQVlKWUlaSUFZYjRRZ0VOQkI4V0hVOXdaVzVUVTB3Z1IyVnVaWEpoZEdWa0lFTmxjblJwWm1sallYUmxNQjBHQTFVZERnUVdCQlQ1NlJiTmRrczNKbUptdG5zcC9lQUV3bjZEbVRBZkJnTlZIU01FR0RBV2dCU21RYVZRZWtONEN6Ylg4ZVVGMkpseUo1dzdhakFOQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBSVVTazkrRTR1bG83ajBIVDhaMWoxSUVkRWFsOEMwc3cvN1VUNkZPaFNxcDk2a1V3ZWEzTTBHcWFZeWhVUXB0enM4Rnh0Z05rVnFXZG8rTkh1V05TRHJjWi9kM2kyVGYwMkJKR2JqcFpsTjRqVGJOSXMvYXBIUU9yRElhcVB0dkFjOUdsZVFqbERSRVd4Z3N1b0E2SXUrSEV2S2thY2lsdzNZZW0rdGt3ZEV3aUp0WHBiQk42c0VnV2J1UW8vZTZqMFR2YnpzcUpDNGMxeUNZaUI4Sk9OODFLZTlXQXZiWWxnMHZBTmF6SzltQURPZzlvc3huNXVCTkh4ekx6bENSQUovQ1dpSkhaUStxenZYWkI5end5NTJrWHNXQ2lMZ2pPUzU3d21QK1FKYXRMSzZRdmQ0WDI2YkFtdjlsTEpIM05jUDJXa0MvR1U3eTFLM1lHSTBRU1dPTmVxWm1seEMvbUZ4RWpzSlR5L0JVUHNsNkZvVkxTdHI1a2J5WFRnWEFOODlSR213MnpQQWJVRU16WFY3SlFGUjJNa1VjTTF4aThsVmRXOXJlc2lBTi9SeCtvcDlzYUdkOHpLbHJnUzNxakpKWDc5cVhBNm05YURwbFJWZWN0a2M3ZnZuaEhyYmRYN3dmekxhbE40SFgydVRxcUltaDJCSElwelkvZzhvbTVHbDZZdlJiT3RyUkFad1JDTVBSdkptM05VOE5TKzVQNmhjZXB5ZktMZ3JLMW5lS3FpRmVIS291aXJLeEkxdm03dURXZFFTQlpMY2txNitqZkpXejhvY0VDMkp4VlNOVGxhdjB0R0U3eGhINFltWGJ0ZGJ4bnFaNlJPOUFsWmxFSXYzTGJMTHlsT21XcTA5MWlvSDJQdnA4VTl4SndJc2FkS2JCUHR1YmtrNWM9IiwiTUlJRnFUQ0NBNUdnQXdJQkFnSUpBTTdmOGlZQjhZTCtNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1Hc3hDekFKQmdOVkJBWVRBa2xNTVFzd0NRWURWUVFJREFKT1FURVJNQThHQTFVRUJ3d0lTR1Z5ZW1Wc2FXRXhGekFWQmdOVkJBb01EbEpUUVNCRGIzSndMQ0JKYm1NdU1Rd3dDZ1lEVlFRTERBTXpSRk14RlRBVEJnTlZCQU1NRERORVV5QlNiMjkwSUVoVFRUQWVGdzB4T0RBek1UVXhNelExTWpKYUZ3MHlPREF6TVRJeE16UTFNakphTUdzeEN6QUpCZ05WQkFZVEFrbE1NUXN3Q1FZRFZRUUlEQUpPUVRFUk1BOEdBMVVFQnd3SVNHVnllbVZzYVdFeEZ6QVZCZ05WQkFvTURsSlRRU0JEYjNKd0xDQkpibU11TVF3d0NnWURWUVFMREFNelJGTXhGVEFUQmdOVkJBTU1ERE5FVXlCU2IyOTBJRWhUVFRDQ0FpSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnSVBBRENDQWdvQ2dnSUJBUEYyeElERXVJc2VJMHJReDRvNlRJRmhqNlRSVTJYTnhlMnI1KzViU2kxZTBqOTVPRDlTemE0aTJHZnFJL2dUdGovSFBiUUUwUGpyWklUVlJSdjNZd09DYk0wUjBqUGFXeHFvNXZBTzVObzJzSHZJcFkxQ3lIckhPNU9zcDQ1N1FzcWI1YnRPMm41bE1iTGh1RWEwYS9najdHYTN0VCswTHk1QzFjeGVyOXI2cXFRVHVscWx1aHNSTFBLN2JPeHZsN0NUMnpjSlZZMDlOZENka3dNQnQ5ak84eE5kVjhhVVBLL3dNRUJrOFFCMTY2Tm50dXlMNVFQQUVZL0EvakZsOUdQUnhVUjRqRWNxbmEvSVNrbUc1UHB4RVAzbFlrS1pBY3h1MVBDd2VmTlhnNXdnZDhuQ1BOc1dKL0FrTGZnbUVmV3ZFZnlRUlBNWXhzdmJ3VlZHc2NQRytzVXphU1kzcit3blVnVTJodmNMaHdqRVk1VCtielNZSGo2am04OG85Q2R5NDNsckE3UW5hVEkxWkt2OVZJcmxLMzZnRkJIQ0hDdlROSyt4RDVUcGhpV1lFckhjMk8zY0tjL1FCN0xzeWZqVGdjM3hZcExwWC9oZkxRbzNtMjVPdDJNK29uRWxkWDE4V2Rib0I4VmtHckdZZkkvZWwxVVFhbUQ5RUY0N0FQZDlqMVE4eW5ZaGQzckZuWnUxMExvOXdLajV1YTZBMVBCdUgyNzFsYS9sZUhJZDVMTGUrbUg5REZJdFNDUWw1Vytzbk00d2FXSnhFclNoR2RpNmVXMHRLd0l0aTZ5TThNQVRUOXlLcGRnekNVdnBMSDZidyt3ZWlRbFh1bERBbVZnam52U0dSbVVxOXlGNThwbURZMzgwVEthaktBQ3VneXNSalVYT2V0STFBZ01CQUFHalVEQk9NQXdHQTFVZEV3UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZLWkJwVkI2UTNnTE50Zng1UVhZbVhJbm5EdHFNQjhHQTFVZEl3UVlNQmFBRktaQnBWQjZRM2dMTnRmeDVRWFltWElubkR0cU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQzVtczBYM2k5dFB6YUZtZjl0eERsOE40YnpNUjRYNXdjTjlySzdiSXU1R0xtWlZycHlJdnF2YVV3NFZFazM5TnRleU1ybzVsRERjMW03QXZuVzRYQnBPeStBQTd3TEFXcWU1a0xOdnpobzN2YmRNMXQ3ZTJXRnhYZFZ5T1VGazdIU2l0ZUNWWVk0S1JGczFpQnlMeC8rSnpZSnd4RElWRG5WSXQ5NHYvajNLaDQvYVZRbnBaY1prdGlIUnNHdFRndTE1ejExc01QNy9Zc0NtSHNtc1FwdWN4QWsralNHNW1PQ2crSDdHRUNEWmlDN1RZNU9CaFU2SDkzNE9PN0NLVERycTl0b0ZuVkptZ01Pd2xmS2NkZ0pWbENmUUhYaUYrWUtqazhwaHRLN3V3Ri9wRVpXdzhMRGVLZGZLRGJrWmI4Y0tBY0lnVFdhdU9lN2xlZmFRNHVTYWVjNUVIL3NRd3B3Z216a09FOEpmZzEySEo4bnRKSjF0d005RzNFcnRmSTFvRDFtWkdpbmVseG1rdXV2bzEyTEp3L2VxZlNET3FYZW1RYzVmTi8rWWgxNnM0UUNMaVdndkFmeTMrMzMxUWp3cC82SFdjZVdHODUvQnd5cmdtNHpsSThiM0xMRmdYYnU5aEFyLzM5NlhTTzMzWGl4N1gxV1lQZ0JUNHUrZlhYNnJ6WElLYzY0Z3J2QWY4MG9rdHRUZUJ6VXpYeWNrRXRkOXdnTmVpUmpJMXlrRnU4NEtaN1JkVDJiVjdZZXRXWCt2UTV1ZjhObXlFNFhCa2RldWdRSSt6amt0b2d6dW41V2dFb3cvcGJ4NFo2bXJSWE9YVEx3aXY0SnhPYTNUZ0pkNk84WVlad1ZzbVVDUXdlTE5rUjcxdHNqM3FzRGJBcmJncXFtQVdPa3ZnPT0iXX0.ZXlKaGJHY2lPaUpTVTBFdFQwRkZVQ0lzSW1WdVl5STZJa0V4TWpoRFFrTXRTRk15TlRZaUxDSjROV01pT2xzaVRVbEpTbEJFUTBORFExTm5RWGRKUWtGblNVTkZRMFYzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkWWFrVk1UVUZyUjBFeFZVVkNhRTFEVTFWM2VFTjZRVXBDWjA1V1FrRm5UVUZyTlVKTlVYZDNRMmRaUkZaUlVVdEVRVTVUVlRCRmVFWlVRVlJDWjA1V1FrRnpUVVJFVGtWVk1sWnFaRmhLYkVsRVNYVk5SRVZrVFVKelIwRXhWVVZCZDNkVlkyNU9hRXh0YkhWa1IxWjVZbGRzYTJGWFJqQmFVelZxWWpJd2QwaG9ZMDVOVkd0M1RYcE5lRTFFWTNoT2VrVXdWMmhqVGsxcWEzZE5la2swVFVSamVFNTZSVEJYYWtKM1RWRnpkME5SV1VSV1VWRkhSWGRLU2xSRVJWRk5RVFJIUVRGVlJVTkNUVWhXVnpWeVltMDVNMkpxUlZOTlFrRkhRVEZWUlVKNFRVcFRSMVo1Wlcxc2MyRlliR2hOVVhkM1EyZFpSRlpSVVV0RmQwNVRWVEJGZUVWVVFWQkNaMDVXUWtGelZFTkVUa1ZWTWxacVpGaEtiRTFTYjNkSFFWbEVWbEZSUkVSQ1JucGFXRW95V2xoS1pscFhOV3BqYm14M1pFZHNkbUpxUTBOQlUwbDNSRkZaU2t0dldrbG9kbU5PUVZGRlFrSlJRVVJuWjBWUVFVUkRRMEZSYjBOblowVkNRVXRRWW5aNlRYRm1OR3BITVRGbFdHMXdaVkI1V1hFNWNsaEdNU3RRWWxaeFZWUjVORE5RVUhJd2IzVjBNemxYV1cxdlFUQXJjV3BUVG5oaFRWWndPRWtyWVdONGVqUk9WeTlNTUVKMk5VVlJXbG92WmprNE9UWlJNMGt6VjBOcE1HaDJjR05GYjB0YVUzUkNTVTh5UTFaV2JHbFVVbmRpYUd4M1ZWZEJaV2RQY25GMFNubE1RMDlUVGk5cFZuUkdNamtyTUVRd01ra3hlWEJCVVd0dGRGbGhSekJUWVdKSGREaHZibTVpWVVZeVkxRlBNbTltVDFZelJXVmpZV1l5TVdsbFZrd3dVVTV4ZUcxRFIzZERLekUyUXpaS05FYzBRWFYzUm5ocmNsTnNPVEJOUzFSeVdEUTRVRmw0WjJkSE9XSXljMWhLVFUxdFNVeE1Sa3hpUjFvcmQyRXhVMmhXY1VWdk16Rm1iblJGY25odlFWcFVlV2RNTlhBNFkxaElhRU4zVGt4WlFrTjBLMHhRWTB4NWFqRjZiRWhtVmpaMGJWTlBXR05aVVZBMGFIbHFla1p6WldGSVYwOHJhRmxyUkRSamJYcFBZME5CZDBWQlFXRlBRMEptUVhkbloxaHpUVWxKUmtsbldVUldVakJTUWtsSlJrZFVRME5DVWxkRFNVaGtNMlI1TlhOaFZ6VXhaVWhLYTA1RVFYZE1iV2cyWWtkR2FVeHRlR2haYVRWc1lsZE5kVmt5T1hSbmFIaHpZVmMxTVdWSVNtdE9SRUYzVEcxb05tSkhSbWxNYlhob1dXazFiR0pYVFhWWk1qbDBaMmR3YzJGWE5URmxTRXByVGtSQmQyZHBRak5rTTJOMVlrZHNkV1JZYUhsYVJFMTNUVU0xYjJWdGVHaFphVFZ6V1ZkSmRWcFhNV3BNYlU1MllsbEpZMkpIYkhWa1dHaDVXa1JOZDAxRE5XOWxiWGhvV1drMWMxbFhTWFZhVnpGcVRHMU9kbUpaU1V0aVIyeDFaRmhvZVZwRVRYZE5TVWxuWkROa00weHRlSEJpYmxZMFkwaE5NRTFxUVhWaFNIQnpXVmRKZFdKSFJtbE1iVlowV1hrMWFtSXlNa05JUjNod1ltNVdOR05JVFRCTmFrRjFZVWh3YzFsWFNYVmlSMFpwVEcxV2RGbDVOV3BpTWpKRFEyMTRjR0p1VmpSalNFMHdUV3BEUTBsSVpETmtlVFZ6WVZjMU1XVklRbnBPUkVWM1RHMW9ObUpIUm1sTWJYaG9XV2sxYkdKWFRYVlpNamwwWjJoNGMyRlhOVEZsU0VKNlRrUkZkMHh0YURaaVIwWnBURzE0YUZscE5XeGlWMDExV1RJNWRHZG5jSE5oVnpVeFpVaENlazVFUlhkbmFVSXpaRE5qZFdKSGJIVmtXR2g0V1ZSRk1FMUROVzlsYlhob1dXazFjMWxYU1hWYVZ6RnFURzFPZG1KWlNXTmlSMngxWkZob2VGbFVSVEJOUXpWdlpXMTRhRmxwTlhOWlYwbDFXbGN4YWt4dFRuWmlXVWxMWWtkc2RXUllhSGhaVkVVd1RVbEpaMlF6WkROTWJYaHdZbTVXTkdOWFJYaE5la0YxWVVod2MxbFhTWFZpUjBacFRHMVdkRmw1TldwaU1qSkRTRWQ0Y0dKdVZqUmpWMFY0VFhwQmRXRkljSE5aVjBsMVlrZEdhVXh0Vm5SWmVUVnFZakl5UTBOdGVIQmlibFkwWTFkRmVFMTZRME5KU0dRelpIazFjMkZYTlRGbFNFWm9UVlJKZDB4dGFEWmlSMFpwVEcxNGFGbHBOV3hpVjAxMVdUSTVkR2RvZUhOaFZ6VXhaVWhHYUUxVVNYZE1iV2cyWWtkR2FVeHRlR2haYVRWc1lsZE5kVmt5T1hSblozQnpZVmMxTVdWSVJtaE5WRWwzWjJsQ00yUXpZM1ZpUjJ4MVpGaG9lRmxVUlhoTlF6VnZaVzE0YUZscE5YTlpWMGwxV2xjeGFreHRUblppV1VsallrZHNkV1JZYUhoWlZFVjRUVU0xYjJWdGVHaFphVFZ6V1ZkSmRWcFhNV3BNYlU1MllsbEpTMkpIYkhWa1dHaDRXVlJGZUUxSlNXMVpWelZvWWtoc01HRlhUbnBNYlhod1ltNVdOR05JVFRCTlZFRjFZVWh3YzFsWFNYVmlSMFpwVEcxV2RGbDVOV3BpTWpKRFNtMUdkVmxYZURWa1IyeHFZM2sxYzJGWE5URmxTRUo2VGtSSmQweHRhRFppUjBacFRHMTRhRmxwTld4aVYwMTFXVEk1ZEdkcFdtaGliVVp6WlZoU2NGa3pUWFZpUjJ4MVpGaG9lRmxVUlhoTlF6VnZaVzE0YUZscE5YTlpWMGwxV2xjeGFreHRUblppV1VsdFdWYzFhR0pJYkRCaFYwNTZURzE0Y0dKdVZqUmpWMFY0VFdwQmRXRkljSE5aVjBsMVlrZEdhVXh0Vm5SWmVUVnFZakl5UTBwdFJuVlpWM2cxWkVkc2FtTjVOWE5oVnpVeFpVaEdhRTFVVFhkTWJXZzJZa2RHYVV4dGVHaFphVFZzWWxkTmRWa3lPWFJuYVZwb1ltMUdjMlZZVW5CWk0wMTFZa2RzZFdSWWFIaFpWRVV3VFVNMWIyVnRlR2haYVRWeldWZEpkVnBYTVdwTWJVNTJZbGxKVEdKSGJIVmtXR2gzWXpOSmVVMVVRME5JVjNod1ltNVdOR05JVG5sTmFrVjNURzFvTm1KSFJtbE1iWGhvV1drMWJHSlhUWFZaTWpsMFoybEdNMlF6WTNWaVIyeDFaRmhvZDJNelNYbE5WRUYxWVVod2MxbFhTWFZpUjBacFRHMVdkRmw1TldwaU1qSkRRMWQ0TkZsdFJuUlpiVVYzVFc5SlltSklhR2xaVnpGcFdWUkJlVXh0YURaaVIwWnBURzE0YUZscE5XeGlWMDExV1RJNWRHZG9PVE5rTTJOMVlraG9hVmxYTVdsWlZFRjVURzFvTm1KSFJtbE1iWGhvV1drMWJHSlhUWFZaTWpsMFoyaDRNMlF6WTNWaVJ6VjRXVlJGZUV4dGFEWmlSMFpwVEcxNGFGbHBOV3hpVjAxMVdUSTVkR2RuV25OaWJrWm9UVlJIUTBkSGVIVmpWMFY0VFZNMWIyVnRlR2haYVRWeldWZEpkVnBYTVdwTWJVNTJZbGxKWTJRelpETk1iWGgxWTFkRmVVMXBOVzlsYlhob1dXazFjMWxYU1hWYVZ6RnFURzFPZG1KWlNVZGlSelY0V1ZSSmVXZG9hSE5pYmtab1RXcEpkV0ZJY0hOWlYwbDFZa2RHYVV4dFZuUlplVFZxWWpJeVEwTnRlSEJpYmxZMFkxZEZlVTE2UTBOSVIzaHdZbTVXTkdOWFJYbE5la0YxWVVod2MxbFhTWFZpUjBacFRHMVdkRmw1TldwaU1qSkRTVWhrTTJSNU5YTmhWelV4WlVoR2FFMXFUWGRNYldnMllrZEdhVXh0ZUdoWmFUVnNZbGROZFZreU9YUm5aM0J6WVZjMU1XVklSbWhOVkVWNVoyaDRjMkZYTlRGbFNFWm9UVlJGZVV4dGFEWmlSMFpwVEcxNGFGbHBOV3hpVjAxMVdUSTVkR2RwUWpOa00yTjFZa2RzZFdSWWFIaFpWRVY0VFdrMWIyVnRlR2haYVRWeldWZEpkVnBYTVdwTWJVNTJZbGxKVkV0cE5XOWxiWGhvV1drMWMxbFhTWFZhVnpGcVRHMU9kbUpVUVdSQ1owNVdTRkUwUlVablVWVXdPRzlWYUZsRk9HdFFhMjVHVDJ0cWJWcDJVRGxPTjFNMVFUaDNaMXBaUjBFeFZXUkpkMU5DYW1wRFFtazBRVlVyWld0WGVsaGFURTU1V21sYWNsbzNTMll6WjBKTlNpdG5OVzFvWWpaU2RFMUhjM2hEZWtGS1FtZE9Wa0pCV1ZSQmEyeE5UVkZ6ZDBOUldVUldVVkZKUkVGS1QxRlVSVkpOUVRoSFFURlZSVUozZDBsVFIxWjVaVzFXYzJGWFJYaEdla0ZXUW1kT1ZrSkJiMDFFYkVwVVVWTkNSR0l6U25kTVEwSktZbTFOZFUxUmQzZERaMWxFVmxGUlRFUkJUWHBTUmsxNFJsUkJWRUpuVGxaQ1FVMU5SRVJPUlZWNVFsTmlNamt3U1VWb1ZGUlpTVU5GYXpCM1JFRlpSRlpTTUZSQ1FWVjNRWGRGUWk5NlFVNUNaMnR4YUd0cFJ6bDNNRUpCVVhOR1FVRlBRMEZSUlVGa1MzWnBLMFZPTkZsNGIzbENkRnB5UjNWRmVrOHlhRm95V2paT0wzbE1hMnRSTUVFclVsbExTSHBNUW0xTmFIaFFjRGRZTmxaMFptOHJiRFozWkVkcVNWZG1XVmxoYW1OWlpYSkJRblJDSzNwaFRHbEtiR1JhT0hwRU9FMUVjMHQyY25OQlpYcDRaeXRFV21SM2FVdExaRTkwZVRoU2RYTnlNV3hQY1dJelNtZEpUSEYxYlVZcmVDOTZkVnBvZDFreU9WYzBWakpqUlhSVUx6Tm5SR3N5YVdOSE1YWkVVeTg1ZW1WVU1qQjNkR28wYUdvd2VFTnlUVE4xTjNOamFXWnpkMk53ZDI1V1JXcE9jbWdyTTNBeVNHUlRjUzluY0hRcmVtTnRWMjVWUTFOTk56aElNRXRuYW1Rd1RHNVdUVTE2TVM5bmMzZEJWa2RTWTJwcFNtNUZZelZUVlZkeFlsa3dWbm80UTNCdU16ZHJhblYwTVdjMGIzWkhWVXBKZDBWc1VVNXhUVFZMYm5kblNtMHdUM2R6TWpGa1owTk9hMWhOWlRFMWNERnBRblZwTlVFMUwzWjRkbWszU0hGa1pXVkhaMlJPYTBFOVBTSmRmUS5iblFtc3JBd0I0Yy1ueG1VUkxvWHJubUtVNm9QaVFrSkJ5dGtiUTFHWjVpNFB5bDBvcEVtcE0xRUZsY1VZVG56eGNDdWdrRjFoSWJCQmIyc0lVYWl1QkVaM28tNkFNVzFJNlRka1NwVGsxeGlCMWU0ek9oSkxUaVdTY2xCSFBYTlpZNDJlcUZ1SEFBTm9NUHRiOEpRbVd5RExkYmM1VTZRSTNIcFhiOE5ZUzlYXy1CVVQ0LWF4dlliV1huRkthTnlORkdFM1J4bGRCb3hGWEU2cXRNVXdYN25YVFR6alQzLXFtTGFFTzBfbWlzUldRbm02NElXdG9NWkhPNUxmQmUxLXJMQmlyT0N6VzU4VEpuX3BNTU5nM0Nla3J4cXZrRkUyNGo5TW5zZ1lpcHNnVjFneERfS09HNzZBWUVjaFV1U0g5anZzcWNlOUFROWFBOXdKelNrYWcuQUc2Y3FEVWg1RWh5WTh5VFRWQ05aQS5pS0pSNkVmbHNnNWkyT0EtZHJHMlJwTUtTd1RkZlIzaXREMUM3bVBiOTJXX1pKX2tEM2xZU1g0Rk9sMWNzQ1BndTV0SG44WFplalRqMm9VNC1rOGJTTkN4bkMySEktNEdWazhoNDdiWGVLMGw5NHFDV21aX3VLT0ZTcDRoRU93cVhjMGY4aVZQNHRRTmY0MUFOY0FRcWtIUVFIeklsVDJLTzFGQ3N5dzVVcTdYUjEtMXV2WUh5MWkwUVJFX3I5bzV0bUU5VGpaMDJBODVnSW53b2ZiSWdBWnBZcndfc3RGN1FCM2dEUHNCSDZHQnpTXzNfZW50MzV6NDJVQk9MMUNOOGFwNnRiaHYwN1dpUlAxdzEtakZrR2tudER1d2NnM1Q0T3V1dFl3X3d2WE1QOFlHNGF0dTNKM0w3RzVWYXVMRWJLT05hNUI3NWNfY0VXWFloaERHUGpLdkY5MDNxenZtcmhUMy1JVTFVeHZmU2VnMVRxQlNLNlBqdVlkN1Iyb3lUVGZKaFRrQVhTeGxlRjQ4NVNrZDBDVGRqMHAyOVEyQmpFQUR6S3FlSkg5SWdBM25qQ2FyOUREX1ZNY2FrVHZNTW1wOEwzN3VlTHFVMk8xSFFqY1djQ2wtWDlWcVI2ZW04dkJyVlhta0sxNHVydHhDR3hyTWNGY3RSMEI3cFhMd054eV9senVzM3JUQ3RhMWYydU4yRC1URDZYZ1FGXzlmcVE2ekVqbHdxOFUuY1V6RFBmT3lVUDZ5T3dwejhONXpzQQ.Mw5cirD9IF0I_O878R7zzDNeaQmiPqoYco5nojaP-DxYWt7JkfNPa8SUmYuP1wyDwCEQhTli-DxywUxTLV0VtzXSEW8NMQk9iqwrRYDW5neAjRN5LDy7X-4pqZo--kQNw91GuAahhCEtkK_wcG7jrEafgrwLc6MmxHidmHDIo7l_JC4YzRSJ6ikKLGAmblXFIAqquyxCHfsIAr55K8_mOx-Q2KLAo73y2SEh_n3vRZU5XEWXcPOpDo2gYPyct2UAb005GB9D5qzNlFDgKelW8WrVHqY1IlWVzwUgLGytfP-Sdwvc67m6_RqUqIqj_z2gx7noENx7iTbrGLmLJ8ZDlw";

            private readonly string _jweHeaderAsB64 = CardInfoEncryptedMessage.Split(".")[0];


            [Fact]
            public void NotExpiredWhenExpiryIsSixtySecondsInTheFuture()
            {
                ClassUnderTest = JweMessage.JwsHeader.CreateJweHeaderFromEncryptedHeader(_jweHeaderAsB64);

                var verified = ClassUnderTest.VerifyCertChain(new DevJweCryptoPolicy());

                verified.Should().BeTrue();
            }
        }

    }
}